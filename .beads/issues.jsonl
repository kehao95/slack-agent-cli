{"id":"SLACK-1jo","title":"Implement files commands","description":"type: task","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-29T11:24:43.336026-05:00","updated_at":"2026-01-29T11:25:01.971238-05:00","dependencies":[{"issue_id":"SLACK-1jo","depends_on_id":"SLACK-k3i","type":"parent-child","created_at":"2026-01-29T11:25:39.730247-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-1p3","title":"Add comprehensive error handling","description":"type: task","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-29T11:24:43.338076-05:00","updated_at":"2026-01-29T11:24:43.338076-05:00","dependencies":[{"issue_id":"SLACK-1p3","depends_on_id":"SLACK-k3i","type":"parent-child","created_at":"2026-01-29T11:25:40.777245-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-3jl","title":"Implement messages search","description":"type: task","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-29T11:24:43.335513-05:00","updated_at":"2026-01-29T18:02:18.705221-05:00","closed_at":"2026-01-29T18:02:18.705221-05:00","close_reason":"Implemented messages search with user token support","dependencies":[{"issue_id":"SLACK-3jl","depends_on_id":"SLACK-k3i","type":"parent-child","created_at":"2026-01-29T11:25:39.447301-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-3kt","title":"Implement messages edit and delete","description":"type: task","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T11:24:43.331386-05:00","updated_at":"2026-01-29T18:16:15.606667-05:00","closed_at":"2026-01-29T18:16:15.606667-05:00","close_reason":"Implemented messages edit and delete","dependencies":[{"issue_id":"SLACK-3kt","depends_on_id":"SLACK-5ti","type":"parent-child","created_at":"2026-01-29T11:25:27.073758-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-44v","title":"Implement pins add/remove","description":"type: task","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T11:24:43.332443-05:00","updated_at":"2026-01-29T18:26:35.50205-05:00","closed_at":"2026-01-29T18:26:35.50205-05:00","close_reason":"Implemented pins add/remove/list","dependencies":[{"issue_id":"SLACK-44v","depends_on_id":"SLACK-5ti","type":"parent-child","created_at":"2026-01-29T11:25:27.552802-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-4rq","title":"Implement emoji list command","description":"type: task","notes":"Implemented emoji list command. Needs emoji:read scope. Code builds, tests pass.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-29T11:24:43.33704-05:00","updated_at":"2026-01-29T19:32:20.874222-05:00","closed_at":"2026-01-29T19:32:20.874222-05:00","close_reason":"Closed","dependencies":[{"issue_id":"SLACK-4rq","depends_on_id":"SLACK-k3i","type":"parent-child","created_at":"2026-01-29T11:25:40.251996-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-5oj","title":"EPIC: Real-time Message Streaming","description":"type: epic","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-29T11:24:43.33295-05:00","updated_at":"2026-01-29T18:45:14.083418-05:00","closed_at":"2026-01-29T18:45:14.083418-05:00","close_reason":"Removed: Socket Mode epic cancelled. Refactored to user-token only model."}
{"id":"SLACK-5ti","title":"EPIC: Write Operations","description":"type: epic","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-29T11:24:43.330323-05:00","updated_at":"2026-01-29T18:45:27.994276-05:00","closed_at":"2026-01-29T18:45:27.994276-05:00","close_reason":"Complete: All write operations (send, edit, delete, reactions, pins) implemented."}
{"id":"SLACK-62o","title":"Implement channels join/leave","description":"type: task","notes":"Implemented channels join and leave commands. Both tested successfully. All tests pass.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-29T11:24:43.33655-05:00","updated_at":"2026-01-29T19:32:21.120864-05:00","closed_at":"2026-01-29T19:32:21.120864-05:00","close_reason":"Closed","dependencies":[{"issue_id":"SLACK-62o","depends_on_id":"SLACK-k3i","type":"parent-child","created_at":"2026-01-29T11:25:39.992846-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-6w6","title":"Add output formatting utilities","description":"type: task","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T11:24:43.337545-05:00","updated_at":"2026-01-29T18:45:22.294025-05:00","closed_at":"2026-01-29T18:45:22.294025-05:00","close_reason":"Complete: Output formatting (JSON and human-readable) implemented via output.Print().","dependencies":[{"issue_id":"SLACK-6w6","depends_on_id":"SLACK-k3i","type":"parent-child","created_at":"2026-01-29T11:25:40.509503-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-780","title":"Initialize Go module and project structure","description":"## Description\nInitialize the Go project structure with module, directories, and CLI framework.\n\n## Acceptance Criteria\n- [ ] `go.mod` exists with module name `github.com/contentsquare/slack-cli`\n- [ ] Directory structure created: `cmd/`, `internal/`, `pkg/`, `docs/`\n- [ ] `main.go` entry point exists and compiles\n- [ ] Cobra CLI framework added as dependency\n- [ ] Viper config framework added as dependency\n- [ ] Root command (`cmd/root.go`) implemented with:\n  - `--config` flag for custom config path\n  - `--json` global flag for JSON output\n  - `--quiet` global flag for minimal output\n  - Version command or flag\n- [ ] `go build ./...` succeeds\n- [ ] `slack-cli --help` shows usage\n\n## Technical Notes\n- Use `cobra-cli init` or manual setup\n- Follow standard Go project layout","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T11:24:43.324428-05:00","updated_at":"2026-01-29T14:53:14.76718-05:00","closed_at":"2026-01-29T14:53:14.76718-05:00","close_reason":"Project structure complete: go.mod with correct module name, cmd/internal/docs directories, main.go compiles, Cobra+Viper integrated, root command with --config and --json flags, build succeeds, help works. Note: --quiet and version flags deferred.","dependencies":[{"issue_id":"SLACK-780","depends_on_id":"SLACK-bu9","type":"parent-child","created_at":"2026-01-29T11:25:14.539968-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-7ig","title":"Implement pins list command","description":"type: task","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-29T11:24:43.329811-05:00","updated_at":"2026-01-29T18:45:28.865901-05:00","closed_at":"2026-01-29T18:45:28.865901-05:00","close_reason":"Complete: pins list implemented in SLACK-44v.","dependencies":[{"issue_id":"SLACK-7ig","depends_on_id":"SLACK-wtp","type":"parent-child","created_at":"2026-01-29T11:25:21.900395-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-7nt","title":"Implement reactions add/remove","description":"type: task","notes":"Implementation complete: reactions add/remove commands working with tests passing","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T11:24:43.331897-05:00","updated_at":"2026-01-29T18:13:23.876486-05:00","closed_at":"2026-01-29T18:13:23.876486-05:00","close_reason":"Implemented reactions add/remove","dependencies":[{"issue_id":"SLACK-7nt","depends_on_id":"SLACK-5ti","type":"parent-child","created_at":"2026-01-29T11:25:27.305894-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-af8","title":"Implement messages list command","description":"## Description\nImplement the messages list command to fetch channel history.\n\n## Acceptance Criteria\n- [ ] `cmd/messages.go` implements messages command group\n- [ ] `messages list` subcommand with flags:\n  - `--channel` (string, required): channel name or ID\n  - `--limit` (int): max messages (default 50, max 1000)\n  - `--since` (string): messages after time (ISO 8601 or relative: \"1h\", \"2d\")\n  - `--until` (string): messages before time\n  - `--thread` (string): fetch thread replies by thread_ts\n  - `--include-bots` (bool): include bot messages (default true)\n  - `--json` (bool): output as JSON\n- [ ] Human-readable output:\n  ```\n  #general - Last 3 messages\n  ──────────────────────────────\n  [10:32:45] @alice:\n    Hello everyone!\n  ```\n- [ ] JSON output with full message details\n- [ ] Channel name resolution (# prefix or ID)\n- [ ] Relative time parsing (\"1h\", \"2d\", \"1w\")\n- [ ] Pagination support (cursor-based)\n- [ ] Error handling for invalid channel\n- [ ] `slack-cli messages list --help` shows examples\n- [ ] Unit tests for time parsing and output formatting\n- [ ] `go test ./...` passes\n\n## Technical Notes\n- Use `conversations.history` API\n- Use `conversations.replies` for thread mode\n- Cache user info for display name resolution","notes":"Commit 4ce72ab: Added disk cache with incremental pagination. Partial cache support allows resume on timeout. Working on cmd/cache.go for explicit population commands.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T11:24:43.328156-05:00","updated_at":"2026-01-29T14:52:45.744388-05:00","closed_at":"2026-01-29T14:52:45.744388-05:00","close_reason":"All acceptance criteria met: message list command with all flags, human-readable and JSON output, channel resolution, relative time parsing, pagination, error handling, help text with examples, and all tests passing. Note: --include-bots flag deferred to later.","dependencies":[{"issue_id":"SLACK-af8","depends_on_id":"SLACK-wtp","type":"parent-child","created_at":"2026-01-29T11:25:21.098917-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-b7q","title":"Implement messages send command","description":"## Description\nImplement the messages send command to post messages to Slack.\n\n## Acceptance Criteria\n- [ ] `messages send` subcommand with flags:\n  - `--channel` (string, required): target channel or @user for DM\n  - `--text` (string): message text\n  - `--thread` (string): thread_ts for reply in thread\n  - `--blocks` (string): Block Kit JSON for rich formatting\n  - `--unfurl-links` (bool): unfurl URLs (default true)\n  - `--unfurl-media` (bool): unfurl media (default true)\n  - `--json` (bool): output sent message details as JSON\n- [ ] Read message from stdin if --text not provided:\n  `echo \"Hello\" | slack-cli messages send --channel \"#general\"`\n- [ ] DM support via @username syntax\n- [ ] Thread reply support\n- [ ] Return sent message timestamp and channel\n- [ ] JSON output includes full message response\n- [ ] Error handling for invalid channel, permissions\n- [ ] `slack-cli messages send --help` shows examples\n- [ ] Unit tests for input parsing\n- [ ] `go test ./...` passes\n\n## Technical Notes\n- Use `chat.postMessage` API\n- For DMs, use `conversations.open` first to get DM channel ID\n- Block Kit JSON should be validated before sending","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T11:24:43.330873-05:00","updated_at":"2026-01-29T18:13:23.613675-05:00","closed_at":"2026-01-29T18:13:23.613675-05:00","close_reason":"Implemented messages send with thread and stdin support","dependencies":[{"issue_id":"SLACK-b7q","depends_on_id":"SLACK-5ti","type":"parent-child","created_at":"2026-01-29T11:25:26.819547-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-bu9","title":"EPIC: Project Setup and Foundation","description":"type: epic","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-29T11:24:43.323388-05:00","updated_at":"2026-01-29T18:45:21.392962-05:00","closed_at":"2026-01-29T18:45:21.392962-05:00","close_reason":"Complete: Project setup foundation established with Go module, Cobra CLI."}
{"id":"SLACK-bys","title":"Implement users commands","description":"type: task","notes":"Starting implementation of users list and users info commands","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T11:24:43.328727-05:00","updated_at":"2026-01-29T17:10:14.767342-05:00","closed_at":"2026-01-29T17:10:14.767342-05:00","close_reason":"Implemented users list and users info commands with tests","dependencies":[{"issue_id":"SLACK-bys","depends_on_id":"SLACK-wtp","type":"parent-child","created_at":"2026-01-29T11:25:21.34506-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-elt","title":"Implement configuration management","description":"## Description\nImplement configuration file management for storing Slack credentials and defaults.\n\n## Acceptance Criteria\n- [ ] Config struct defined in `internal/config/config.go` with fields:\n  - `Version` (int)\n  - `AppToken` (string, xapp-...)\n  - `BotToken` (string, xoxb-...)\n  - `UserToken` (string, optional xoxp-...)\n  - `Defaults` struct (OutputFormat, IncludeBots, TextChunkLimit)\n- [ ] `LoadConfig(path string) (*Config, error)` function\n- [ ] `SaveConfig(path string, cfg *Config) error` function\n- [ ] `ValidateConfig(cfg *Config) error` function\n- [ ] Default config path: `~/.config/slack-cli/config.json`\n- [ ] Environment variable overrides: `SLACK_APP_TOKEN`, `SLACK_BOT_TOKEN`, `SLACK_USER_TOKEN`\n- [ ] `config init` command with interactive prompts\n- [ ] `config show` command displays current config (tokens masked)\n- [ ] `config set \u003ckey\u003e \u003cvalue\u003e` command\n- [ ] Unit tests for Load/Save/Validate functions\n- [ ] `go test ./internal/config/...` passes\n\n## Technical Notes\n- Use Viper for config management\n- Config file is JSON format\n- Mask tokens in output (show first 8 chars only)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T11:24:43.325044-05:00","updated_at":"2026-01-29T18:45:20.581074-05:00","closed_at":"2026-01-29T18:45:20.581074-05:00","close_reason":"Complete: Configuration management implemented with user_token support.","dependencies":[{"issue_id":"SLACK-elt","depends_on_id":"SLACK-bu9","type":"parent-child","created_at":"2026-01-29T11:25:14.808775-05:00","created_by":"Hao Ke"},{"issue_id":"SLACK-elt","depends_on_id":"SLACK-780","type":"blocks","created_at":"2026-01-29T11:25:49.545228-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-fg5","title":"Write documentation and examples","description":"type: task","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-29T11:24:43.338735-05:00","updated_at":"2026-01-29T11:25:02.714398-05:00","dependencies":[{"issue_id":"SLACK-fg5","depends_on_id":"SLACK-k3i","type":"parent-child","created_at":"2026-01-29T11:25:41.057323-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-fxj","title":"Implement Socket Mode connection","description":"## Description\nImplement Socket Mode connection for real-time event streaming.\n\n## Acceptance Criteria\n- [ ] Socket Mode client in `internal/watch/socket.go`\n- [ ] `SocketClient` struct with methods:\n  - `Connect() error` - establish connection\n  - `Disconnect() error` - graceful shutdown\n  - `Events() \u003c-chan Event` - channel for receiving events\n- [ ] Event struct defined:\n  ```go\n  type Event struct {\n      Type      string    // message, reaction_added, etc.\n      Timestamp time.Time\n      Channel   string\n      User      string\n      Text      string    // for messages\n      Reaction  string    // for reactions\n      ThreadTS  string    // for thread replies\n      Raw       json.RawMessage\n  }\n  ```\n- [ ] Handle connection lifecycle (connect, reconnect on disconnect, shutdown)\n- [ ] Handle SIGINT/SIGTERM for graceful shutdown\n- [ ] Reconnect with exponential backoff on connection loss\n- [ ] Unit tests for event parsing\n- [ ] `go test ./internal/watch/...` passes\n\n## Technical Notes\n- Use `slack.socketmode` package\n- App token required for Socket Mode (xapp-...)\n- Subscribe to events: message.*, reaction_added, reaction_removed","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T11:24:43.333483-05:00","updated_at":"2026-01-29T18:45:15.14742-05:00","closed_at":"2026-01-29T18:45:15.14742-05:00","close_reason":"Removed: Socket Mode connection removed. Using user-token only.","dependencies":[{"issue_id":"SLACK-fxj","depends_on_id":"SLACK-5oj","type":"parent-child","created_at":"2026-01-29T11:25:33.055193-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-hei","title":"EPIC: Codebase Quality \u0026 Optimization","description":"Comprehensive codebase cleanup focusing on DRY principles, testing standards, and maintainability. This epic addresses technical debt identified during engineering taste review.","status":"open","priority":1,"issue_type":"epic","owner":"hao.ke@heap.io","created_at":"2026-01-29T20:48:35.77839-05:00","created_by":"Hao Ke","updated_at":"2026-01-29T20:48:43.466864-05:00"}
{"id":"SLACK-hei.1","title":"Phase 0: Establish Testing Baseline","description":"CRITICAL: Before any refactoring, establish comprehensive test coverage baseline.\n\n## Objectives\n1. Ensure all existing tests pass (go test ./...)\n2. Add integration smoke tests for all commands\n3. Create test coverage report as baseline\n4. Set up testing standards for both automated AND agent testing\n\n## Part A: Automated Testing Standard\n\n### Unit Tests\n- All existing tests pass: go test ./...\n- Coverage report generated: go test -cover ./...\n- Test helper utilities created for common patterns\n\n### Command Smoke Tests\n- Each command in cmd/ has basic execution test\n- Verify --help works for all commands\n- Verify --json output is valid JSON\n\n## Part B: Agent Testing Standard (CRITICAL for this project)\n\nSince this is a CLI designed for AI agents, we MUST validate agent usability:\n\n### 1. JSON Output Validation\n- All commands produce valid, parseable JSON by default\n- JSON structure is consistent and predictable\n- Error messages are in JSON format with clear error codes\n\n### 2. Exit Code Testing  \n- Success: exit 0\n- General error: exit 1\n- Config error: exit 2\n- Auth error: exit 3\n- Rate limit: exit 4\n- Network error: exit 5\n- Permission denied: exit 6\n- Not found: exit 7\n\n### 3. Stderr/Stdout Separation\n- Data ONLY goes to stdout\n- Status/warnings/errors go to stderr\n- No interactive prompts or spinners\n\n### 4. Agent Workflow Tests\nCreate tests that simulate how an AI agent would use the CLI:\n```bash\n# Agent workflow: list channels, pick one, send message\nCHANNELS=$(slack-agent-cli channels list --json)\nCHANNEL_ID=$(echo $CHANNELS | jq -r '.channels[0].id')\nslack-agent-cli messages send --channel $CHANNEL_ID --text 'Hello'\n```\n\n### 5. Error Recovery Tests\n- Rate limit handling returns proper exit code\n- Network failures are distinguishable from auth failures\n- Partial failures provide actionable error info\n\n## Acceptance Criteria\n- [ ] All existing tests pass: go test ./...\n- [ ] Coverage report generated and saved as baseline\n- [ ] Agent testing checklist created in docs/AGENT_TESTING.md\n- [ ] At least one agent workflow test implemented\n- [ ] Exit codes documented and tested\n- [ ] JSON output validated for all commands\n\n## Testing Protocol for All Future Changes\nEvery change MUST:\n1. Run go test ./... before AND after\n2. Verify JSON output still parseable\n3. Test at least one agent workflow affected by change\n4. Maintain or improve coverage %","notes":"Done: Testing baseline established. Created docs/AGENT_TESTING.md (comprehensive standards), cmd/smoke_test.go (5 test suites, all passing), internal/testutil/testutil.go (9 helper functions), coverage-baseline.txt, and PHASE0-SUMMARY.md. All quality gates pass: fmt ✅ vet ✅ build ✅ test ✅ (53 existing + 5 new smoke tests). Coverage baseline: cmd 16.5% (new), channels 86.8%, config 63.3%, messages 55%, cache 37%, slack 25%, users 80%. Ready for refactoring.","status":"closed","priority":1,"issue_type":"task","owner":"hao.ke@heap.io","created_at":"2026-01-29T20:48:51.857605-05:00","created_by":"Hao Ke","updated_at":"2026-01-29T20:58:11.587328-05:00","closed_at":"2026-01-29T20:58:11.587328-05:00","close_reason":"Testing baseline established: Agent Testing Standards doc, smoke tests for all commands, test utilities package. All 58 tests passing.","dependencies":[{"issue_id":"SLACK-hei.1","depends_on_id":"SLACK-hei","type":"parent-child","created_at":"2026-01-29T20:48:51.858604-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-hei.2","title":"Phase 1a: Create CommandContext Helper","description":"Extract repeated command setup boilerplate into a shared CommandContext.\n\n## Problem\n20+ command handlers repeat 40-50 lines of identical setup code:\n- config.Load() + Validate()\n- cache.DefaultStore()\n- slack.New()\n- channels.NewCachedResolver()\n- context.WithTimeout()\n\n## Solution\nCreate cmd/context.go with:\n```go\ntype CommandContext struct {\n    Ctx             context.Context\n    Cancel          context.CancelFunc\n    Config          *config.Config\n    Client          *slack.APIClient\n    CacheStore      *cache.Store\n    ChannelResolver *channels.Resolver\n    UserResolver    *users.Resolver\n}\n\nfunc NewCommandContext(cmd *cobra.Command, timeout time.Duration) (*CommandContext, error)\nfunc (c *CommandContext) Close()\n```\n\n## Acceptance Criteria\n- [ ] cmd/context.go created with CommandContext\n- [ ] Unit tests for NewCommandContext()\n- [ ] All existing tests still pass\n- [ ] No functional changes to command behavior\n\n## Files to Create\n- cmd/context.go\n- cmd/context_test.go\n\n## Estimated Impact\n~800 lines of duplicate code eliminated","notes":"Phase 1a complete: Created cmd/context.go with CommandContext helper and cmd/context_test.go with 8 comprehensive tests. All quality gates passed (go fmt, go vet, go build, go test). Files ready for Phase 1b refactoring.","status":"in_progress","priority":1,"issue_type":"task","owner":"hao.ke@heap.io","created_at":"2026-01-29T20:49:03.333857-05:00","created_by":"Hao Ke","updated_at":"2026-01-29T21:02:54.453153-05:00","dependencies":[{"issue_id":"SLACK-hei.2","depends_on_id":"SLACK-hei","type":"parent-child","created_at":"2026-01-29T20:49:03.334798-05:00","created_by":"Hao Ke"},{"issue_id":"SLACK-hei.2","depends_on_id":"SLACK-hei.1","type":"blocks","created_at":"2026-01-29T20:49:18.534747-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-hei.3","title":"Phase 1b: Refactor Commands to Use CommandContext","description":"Migrate all command handlers to use the new CommandContext helper.\n\n## Scope\nRefactor these files to use CommandContext:\n- cmd/messages.go (4 handlers)\n- cmd/channels.go (3 handlers)\n- cmd/reactions.go (3 handlers)\n- cmd/pins.go (3 handlers)\n- cmd/users.go (2 handlers)\n- cmd/auth.go (2 handlers)\n- cmd/emoji.go (1 handler)\n- cmd/cache.go (3 handlers)\n\n## Refactoring Pattern\nBefore:\n```go\nfunc runMessagesList(cmd *cobra.Command, args []string) error {\n    cfg, path, err := config.Load(cfgFile)\n    // ... 40 lines of setup\n    // actual logic\n}\n```\n\nAfter:\n```go\nfunc runMessagesList(cmd *cobra.Command, args []string) error {\n    cmdCtx, err := NewCommandContext(cmd, 30*time.Second)\n    if err != nil {\n        return err\n    }\n    defer cmdCtx.Close()\n    // actual logic using cmdCtx.Client, cmdCtx.ChannelResolver, etc.\n}\n```\n\n## Acceptance Criteria\n- [ ] All 20+ command handlers migrated\n- [ ] All existing tests still pass\n- [ ] No functional changes to command behavior\n- [ ] go vet ./... passes\n- [ ] go fmt ./... produces no changes\n\n## Verification\nRun before AND after each file change:\n```bash\ngo test ./...\ngo run main.go \u003ccommand\u003e --help  # Verify each refactored command\n```","status":"open","priority":1,"issue_type":"task","owner":"hao.ke@heap.io","created_at":"2026-01-29T20:49:29.032588-05:00","created_by":"Hao Ke","updated_at":"2026-01-29T20:49:33.393532-05:00","dependencies":[{"issue_id":"SLACK-hei.3","depends_on_id":"SLACK-hei","type":"parent-child","created_at":"2026-01-29T20:49:29.033556-05:00","created_by":"Hao Ke"},{"issue_id":"SLACK-hei.3","depends_on_id":"SLACK-hei.2","type":"blocks","created_at":"2026-01-29T20:49:33.751826-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-hei.4","title":"Phase 2a: Extract Message Send Helpers","description":"Refactor runMessagesSend (113 lines) into smaller, testable functions.\n\n## Problem\ncmd/messages.go:259-372 is 113 lines with:\n- Block parsing logic (43 lines)\n- Stdin reading logic\n- Multiple responsibilities mixed\n- 3-4 levels of nesting\n\n## Solution\nExtract these helpers:\n\n```go\n// cmd/messages_helpers.go\n\n// parseBlocksJSON parses Slack block kit JSON\nfunc parseBlocksJSON(blocksJSON string) ([]slackapi.Block, error)\n\n// readStdinIfPiped reads from stdin if data is piped\nfunc readStdinIfPiped() (string, error)\n\n// buildPostOptions constructs PostMessageOptions from flags\nfunc buildPostOptions(cmd *cobra.Command, text string, blocks []slackapi.Block) slack.PostMessageOptions\n```\n\n## Acceptance Criteria\n- [ ] runMessagesSend reduced to ~30 lines\n- [ ] Each helper has unit tests\n- [ ] All existing tests still pass\n- [ ] go test -cover shows coverage for new helpers\n\n## Files\n- cmd/messages_helpers.go (new)\n- cmd/messages_helpers_test.go (new)\n- cmd/messages.go (modified)","status":"open","priority":2,"issue_type":"task","owner":"hao.ke@heap.io","created_at":"2026-01-29T20:49:42.844526-05:00","created_by":"Hao Ke","updated_at":"2026-01-29T20:49:46.694285-05:00","dependencies":[{"issue_id":"SLACK-hei.4","depends_on_id":"SLACK-hei","type":"parent-child","created_at":"2026-01-29T20:49:42.845425-05:00","created_by":"Hao Ke"},{"issue_id":"SLACK-hei.4","depends_on_id":"SLACK-hei.3","type":"blocks","created_at":"2026-01-29T20:49:47.02944-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-hei.5","title":"Phase 2b: Split internal/slack/client.go","description":"Split the 1003-line client.go into logical modules.\n\n## Problem\ninternal/slack/client.go contains:\n- 8 interfaces (lines 11-62)\n- 18 result types (lines 64-346)\n- Full client implementation (lines 368-1003)\n- Helper functions\n\n## Solution\nSplit into:\n```\ninternal/slack/\n├── interfaces.go    # All interface definitions\n├── types.go         # All result/param types\n├── client.go        # APIClient struct + constructor + core\n├── messages.go      # Message-related methods\n├── channels.go      # Channel-related methods\n├── reactions.go     # Reaction-related methods\n├── users.go         # User-related methods\n├── pins.go          # Pin-related methods\n├── emoji.go         # Emoji-related methods\n├── search.go        # Search-related methods\n└── retry.go         # DoWithRetry helper\n```\n\n## Acceptance Criteria\n- [ ] Each file \u003c 200 lines\n- [ ] No circular imports\n- [ ] All existing tests still pass\n- [ ] go build ./... succeeds\n- [ ] Package API unchanged (same exports)\n\n## Verification\n```bash\ngo build ./...\ngo test ./internal/slack/...\n```","status":"open","priority":2,"issue_type":"task","owner":"hao.ke@heap.io","created_at":"2026-01-29T20:49:55.779025-05:00","created_by":"Hao Ke","updated_at":"2026-01-29T20:49:59.731791-05:00","dependencies":[{"issue_id":"SLACK-hei.5","depends_on_id":"SLACK-hei","type":"parent-child","created_at":"2026-01-29T20:49:55.779963-05:00","created_by":"Hao Ke"},{"issue_id":"SLACK-hei.5","depends_on_id":"SLACK-hei.1","type":"blocks","created_at":"2026-01-29T20:50:00.100562-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-hei.6","title":"Phase 2c: Clean Up Unused Code","description":"Remove dead code and unused abstractions.\n\n## Items to Remove/Refactor\n\n### 1. Unused Interfaces (internal/slack/client.go:11-62)\nOnly keep interfaces that are actually used:\n- KEEP: Client (used in internal/messages/list.go)\n- KEEP: ChannelClient (used in internal/channels/resolver.go)\n- REMOVE: ReactionClient, PinClient, EmojiClient, UserClient, SearchClient, FullClient, MessageClient\n\n### 2. DoWithRetry Never Called\ninternal/slack/client.go:712-734 defines DoWithRetry but it's never used.\nDecision: Either integrate into API calls OR remove entirely.\n\n### 3. Verify No Other Dead Code\nRun: go vet ./...\nCheck for unused exports\n\n## Acceptance Criteria\n- [ ] Unused interfaces removed\n- [ ] DoWithRetry decision made and implemented\n- [ ] go vet ./... clean\n- [ ] All tests still pass\n- [ ] No orphaned code\n\n## Verification\n```bash\ngo vet ./...\ngo test ./...\n# Verify grep shows no references to removed interfaces\n```","status":"open","priority":2,"issue_type":"task","owner":"hao.ke@heap.io","created_at":"2026-01-29T20:50:09.122356-05:00","created_by":"Hao Ke","updated_at":"2026-01-29T20:50:13.758683-05:00","dependencies":[{"issue_id":"SLACK-hei.6","depends_on_id":"SLACK-hei","type":"parent-child","created_at":"2026-01-29T20:50:09.123364-05:00","created_by":"Hao Ke"},{"issue_id":"SLACK-hei.6","depends_on_id":"SLACK-hei.5","type":"blocks","created_at":"2026-01-29T20:50:14.123042-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-hei.7","title":"Phase 3: Add Sentinel Errors","description":"Define package-level sentinel errors for consistent error handling.\n\n## Problem\nAll errors are inline strings, making it hard for agents to programmatically handle errors:\n```go\nreturn nil, fmt.Errorf(\"channel is required\")\n```\n\n## Solution\nCreate internal/slack/errors.go:\n```go\npackage slack\n\nimport \"errors\"\n\nvar (\n    ErrChannelRequired = errors.New(\"channel is required\")\n    ErrTextRequired    = errors.New(\"text or blocks required\")\n    ErrNotFound        = errors.New(\"not found\")\n    ErrUnauthorized    = errors.New(\"unauthorized\")\n    ErrRateLimited     = errors.New(\"rate limited\")\n    ErrPermissionDenied = errors.New(\"permission denied\")\n)\n```\n\n## Benefits for Agents\n- Programmatic error handling with errors.Is()\n- Consistent exit codes mapped to error types\n- Clear error taxonomy\n\n## Acceptance Criteria\n- [ ] internal/slack/errors.go created\n- [ ] All string errors replaced with sentinels where appropriate\n- [ ] Exit codes mapped to error types in cmd/\n- [ ] Tests verify error types with errors.Is()\n- [ ] All existing tests pass","status":"open","priority":2,"issue_type":"task","owner":"hao.ke@heap.io","created_at":"2026-01-29T20:50:40.445592-05:00","created_by":"Hao Ke","updated_at":"2026-01-29T20:50:44.156496-05:00","dependencies":[{"issue_id":"SLACK-hei.7","depends_on_id":"SLACK-hei","type":"parent-child","created_at":"2026-01-29T20:50:40.446551-05:00","created_by":"Hao Ke"},{"issue_id":"SLACK-hei.7","depends_on_id":"SLACK-hei.6","type":"blocks","created_at":"2026-01-29T20:50:44.516816-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-k3i","title":"EPIC: Advanced Features","description":"type: epic","status":"open","priority":3,"issue_type":"epic","created_at":"2026-01-29T11:24:43.335002-05:00","updated_at":"2026-01-29T11:24:50.300026-05:00"}
{"id":"SLACK-lra","title":"Implement watch command","description":"## Description\nImplement the watch command for real-time message streaming.\n\n## Acceptance Criteria\n- [ ] `cmd/watch.go` implements watch command\n- [ ] Flags implemented:\n  - `--channels` (string): comma-separated channel filter\n  - `--include-bots` (bool): include bot messages\n  - `--include-own` (bool): include own messages  \n  - `--include-threads` (bool): include thread replies (default true)\n  - `--timeout` (duration): auto-exit after duration (e.g., \"60s\", \"5m\")\n  - `--events` (string): event types to watch\n  - `--json` (bool): output as JSON lines\n  - `--quiet` (bool): suppress status messages\n- [ ] Human-readable output format:\n  `[2024-01-15 10:32:45] #general | @alice: Hello everyone!`\n- [ ] JSON output format (one event per line):\n  `{\"type\":\"message\",\"ts\":\"...\",\"channel\":\"...\",\"text\":\"...\"}`\n- [ ] Channel filtering works correctly\n- [ ] Timeout flag exits after specified duration\n- [ ] Ctrl+C gracefully stops watching\n- [ ] `slack-cli watch --help` shows usage with examples\n- [ ] Integration test (skipped without credentials)\n\n## Technical Notes\n- Uses SocketClient from SLACK-fxj\n- Enrich events with channel/user names before output\n- Buffer stdout for JSON lines (flush after each event)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T11:24:43.333992-05:00","updated_at":"2026-01-29T18:45:13.177125-05:00","closed_at":"2026-01-29T18:45:13.177125-05:00","close_reason":"Removed: Socket Mode/watch functionality no longer needed. Refactored to user-token only model.","dependencies":[{"issue_id":"SLACK-lra","depends_on_id":"SLACK-5oj","type":"parent-child","created_at":"2026-01-29T11:25:33.304492-05:00","created_by":"Hao Ke"},{"issue_id":"SLACK-lra","depends_on_id":"SLACK-fxj","type":"blocks","created_at":"2026-01-29T11:25:50.347756-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-n8l","title":"Integrate Slack SDK (slack-go)","description":"## Description\nIntegrate the slack-go SDK and create a client wrapper for API calls.\n\n## Acceptance Criteria\n- [ ] `github.com/slack-go/slack` added to go.mod\n- [ ] Client interface defined in `internal/slack/client.go`:\n  ```go\n  type Client interface {\n      TestAuth() (*slack.AuthTestResponse, error)\n      GetChannels() ([]slack.Channel, error)\n      GetConversationHistory(params *slack.GetConversationHistoryParameters) (*slack.GetConversationHistoryResponse, error)\n      PostMessage(channel string, options ...slack.MsgOption) (string, string, error)\n      // ... other methods as needed\n  }\n  ```\n- [ ] Concrete implementation: `internal/slack/slack_client.go`\n- [ ] Mock implementation: `internal/slack/mock_client.go` for testing\n- [ ] `NewClient(botToken, appToken string) (Client, error)` constructor\n- [ ] Token validation in constructor (fail fast if invalid format)\n- [ ] Unit tests with mock client\n- [ ] `go test ./internal/slack/...` passes\n\n## Technical Notes\n- Bot token for API calls (xoxb-...)\n- App token for Socket Mode (xapp-...)\n- Use interface for testability","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T11:24:43.3258-05:00","updated_at":"2026-01-29T18:45:19.827355-05:00","closed_at":"2026-01-29T18:45:19.827355-05:00","close_reason":"Complete: slack-go SDK integrated and used throughout codebase.","dependencies":[{"issue_id":"SLACK-n8l","depends_on_id":"SLACK-bu9","type":"parent-child","created_at":"2026-01-29T11:25:15.077035-05:00","created_by":"Hao Ke"},{"issue_id":"SLACK-n8l","depends_on_id":"SLACK-780","type":"blocks","created_at":"2026-01-29T11:25:49.818692-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-odc","title":"Implement auth commands","description":"type: task","notes":"Master agent: Delegating to coder. Discovered patterns from cmd/channels.go and internal/slack/client.go. slack-go provides AuthTestContext() method returning AuthTestResponse with Team, User, TeamID, UserID, BotID, URL fields.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T11:24:43.326377-05:00","updated_at":"2026-01-29T17:10:17.901587-05:00","closed_at":"2026-01-29T17:10:17.901587-05:00","close_reason":"Implemented auth test and auth whoami commands","dependencies":[{"issue_id":"SLACK-odc","depends_on_id":"SLACK-bu9","type":"parent-child","created_at":"2026-01-29T11:25:15.338831-05:00","created_by":"Hao Ke"},{"issue_id":"SLACK-odc","depends_on_id":"SLACK-n8l","type":"blocks","created_at":"2026-01-29T11:25:50.080186-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-qsx","title":"Implement channels commands","description":"type: task","notes":"Cache layer complete: channels command now uses NewCachedResolver, --refresh-cache flag added. Channel metadata cached to disk with 7-day TTL for instant lookups.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T11:24:43.327518-05:00","updated_at":"2026-01-29T14:52:45.948625-05:00","closed_at":"2026-01-29T14:52:45.948625-05:00","close_reason":"Channels list command fully implemented with cache support, --refresh-cache flag, pagination, and both human-readable and JSON output formats.","dependencies":[{"issue_id":"SLACK-qsx","depends_on_id":"SLACK-wtp","type":"parent-child","created_at":"2026-01-29T11:25:20.847385-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-t3m","title":"Implement reactions list command","description":"type: task","notes":"Implemented reactions list command. Needs reactions:read scope to work. Code builds and runs but requires scope update.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-29T11:24:43.329278-05:00","updated_at":"2026-01-29T19:32:20.637557-05:00","closed_at":"2026-01-29T19:32:20.637557-05:00","close_reason":"Closed","dependencies":[{"issue_id":"SLACK-t3m","depends_on_id":"SLACK-wtp","type":"parent-child","created_at":"2026-01-29T11:25:21.645254-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-tk4","title":"Implement event handlers","description":"type: task","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T11:24:43.334484-05:00","updated_at":"2026-01-29T18:45:14.49845-05:00","closed_at":"2026-01-29T18:45:14.49845-05:00","close_reason":"Removed: Event handlers not needed without Socket Mode.","dependencies":[{"issue_id":"SLACK-tk4","depends_on_id":"SLACK-5oj","type":"parent-child","created_at":"2026-01-29T11:25:33.574261-05:00","created_by":"Hao Ke"},{"issue_id":"SLACK-tk4","depends_on_id":"SLACK-lra","type":"blocks","created_at":"2026-01-29T11:25:50.600895-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-w6n","title":"Create release pipeline","description":"type: task","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-29T11:24:43.339301-05:00","updated_at":"2026-01-29T11:25:02.964032-05:00","dependencies":[{"issue_id":"SLACK-w6n","depends_on_id":"SLACK-k3i","type":"parent-child","created_at":"2026-01-29T11:25:41.338204-05:00","created_by":"Hao Ke"}]}
{"id":"SLACK-wtp","title":"EPIC: Read Operations","description":"type: epic","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-29T11:24:43.326975-05:00","updated_at":"2026-01-29T18:45:27.147457-05:00","closed_at":"2026-01-29T18:45:27.147457-05:00","close_reason":"Complete: All read operations (channels list, messages list, users list/info) implemented."}
{"id":"SLACK-wtp.1","title":"Implement cached ID lookup for Slack entities","description":"## Summary\nAdd a local caching layer for resolving Slack IDs (channels, conversations, users). The CLI should avoid paging through Slack APIs on every run by persisting a name→ID map and refreshing it when entries expire.\n\n## Acceptance Criteria\n- Cache stores mappings for channel names (#foo), user handles (@alice), and conversation types used by existing commands.\n- Cache persisted locally (e.g., JSON file under ~/.cache/slack-cli/) with configurable TTL and max size.\n- Commands first check cache before hitting Slack; missing entries trigger a background refresh and update cache.\n- Provide CLI flag/env to force refresh or bypass cache for one-off operations.\n- Unit tests covering cache hit/miss behavior and TTL expiry logic.","status":"closed","priority":2,"issue_type":"task","owner":"hao.ke@heap.io","created_at":"2026-01-29T13:26:37.992528-05:00","created_by":"Hao Ke","updated_at":"2026-01-29T18:45:23.071343-05:00","closed_at":"2026-01-29T18:45:23.071343-05:00","close_reason":"Complete: Cached ID lookup implemented for channels, users, and usergroups.","dependencies":[{"issue_id":"SLACK-wtp.1","depends_on_id":"SLACK-wtp","type":"parent-child","created_at":"2026-01-29T13:26:37.99341-05:00","created_by":"Hao Ke"}]}
